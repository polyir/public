<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Noor Scroll Motion</title>
<style>
  html,body{margin:0;padding:0;background:#000;height:100%;}
  #noor-scroll{position:relative;}
  .scroll-space{height:200vh;}
  .sticky-wrap{position:sticky;top:0;height:100vh;overflow:hidden;background:#000;display:flex;align-items:center;justify-content:center;}
  .sticky-wrap video{width:100%;height:100%;object-fit:cover;max-width:100%;max-height:100%;}
  .hint{position:absolute;bottom:10px;left:50%;transform:translateX(-50%);color:#bbb;font:12px/1 system-ui,tahoma;opacity:.7}

  /* HIDE SCROLLBARS, keep scroll working */
  html, body { -ms-overflow-style:none; scrollbar-width:none; }
  html::-webkit-scrollbar, body::-webkit-scrollbar { width:0; height:0; display:none; }
</style>

</head>
<body>
<section id="noor-scroll">
  <div class="scroll-space">
    <div class="sticky-wrap">
      <video id="noorVideo" src="https://assets.zyrosite.com/AoP4ao43OesWzGXd/noor-animo-2s5GW5L1hDt4MaVJ.mp4" muted playsinline preload="none" loading="lazy" aria-label="Project Noor scroll-scrub video"></video>
      <div class="hint">اسکرول کن ▶︎</div>
    </div>
  </div>
</section>
<script>
(() => {
  const video = document.getElementById('noorVideo');
  const space = document.querySelector('#noor-scroll .scroll-space');
  let dur = 0, ready = false, rafId = null;
  const io = new IntersectionObserver(e => e.forEach(en => en.isIntersecting ? loop() : cancelAnimationFrame(rafId)), {threshold:0});
  io.observe(space);
  const prime = () => video.play().then(() => video.pause()).catch(()=>{});
  const onMeta = () => { dur = video.duration || 15; ready = true; prime(); };
  video.addEventListener('loadedmetadata', onMeta, {once:true});
  const first = () => { video.load(); removeEventListener('scroll', first); removeEventListener('touchstart', first); };
  addEventListener('scroll', first, {once:true, passive:true});
  addEventListener('touchstart', first, {once:true, passive:true});
  const update = () => {
    if (!ready) return;
    const r = space.getBoundingClientRect();
    const vh = innerHeight;
    const start = Math.max(0, -r.top);
    const total = Math.max(1, r.height - vh);
    const t = Math.min(1, Math.max(0, start / total));
    video.currentTime += (t * dur - video.currentTime) * 0.15;
    if (!video.paused) video.pause();
  };
  const loop = () => { update(); rafId = requestAnimationFrame(loop); };
  addEventListener('resize', update, {passive:true});
})();
</script>
</body>
</html>
